/**
 * Copyright (c) 2011-2016 Moat Inc. All Rights Reserved.
 */
 
!function(){try{!function(e,t){!function(){var e=function(){i.Util=n(),i.Queue=l(),i.VpaidAd=d(),i.MoatTag=o(),s(),r();var e=i.Util.parseQS();if(e){i.qs=e;var t={};for(var a in e)t[a]=e[a];return t.wrapperType="js",new i.MoatTag(i.qs.pcode,t),new i.VpaidAd}};window.getVPAIDAd=function(){if(i.ad)return i.ad;var t=e();return i.ad=t}}();var i={ad:null,version:"2.0",startTime:(new e).getTime(),playerProvidedEventCallbacks:{},VPAIDevents:{AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError"},VPAIDmethods:{resizeAd:"resizeAd",startAd:"startAd",stopAd:"stopAd",pauseAd:"pauseAd",resumeAd:"resumeAd",expandAd:"expandAd",collapseAd:"collapseAd",skipAd:"skipAd"}},n=function(){var n={};return n.safeCallbacks={},n.findMoatScript=function(){for(var e=/moatwrapper/,t=document.getElementsByTagName("script"),i=t.length-1;i>=0;i--){var n=t[i];if(e.test(n.src))return n}},n.parseQS=function(){var e={},t=n.findMoatScript();if(!t)return!1;for(var i=t.src,a=i.split("#")[1],r=a.split("&"),s=r.length-1;s>=0;s--){var o=r[s].split("=");e[o[0]]=decodeURIComponent(o.slice(1).join("="))}return e.vast&&(e.vast=n.expandCachebuster(e.vast)),e},n.getScrUrls=function(){var e,t=i&&i.qs,n=[],a=new RegExp(/^scr\d{1,}/);if(!t)return n;for(key in t)0===key.search(a)&&"string"==typeof(e=t[key])&&n.push(e);return n},n.getParentNode=function(e){return e.parentNode||e.parentElement||!1},n.getElementNodeTree=function(e){if(!e)return!1;for(var t="number"==typeof cap?cap:50,i=[e],a=!1,r=0;r<t&&((a=n.getParentNode(e))&&1===a);r++)e=a,i.push(e)},n.getSafeNode=function(e){if(!e)return!1;if("OBJECT"!==e.nodeName&&"EMBED"!==e.nodeName)return e;for(var t=n.getElementNodeTree(e),i=!1,a=0;a<t.length;a++)if(el&&"OBJECT"!==el.nodeName&&"EMBED"!==el.nodeName){i=el;break}return i},n.hasChildNodes=function(e){return e&&e.childNodes&&e.childNodes.length>0},n.addTagSafely=function(e,i){if(!e||!i)return!1;var a=n.getSafeNode(i);if(!a)return!1;if(n.hasChildNodes(a)){var r=a.childNodes[t.max(0,a.childNodes.length-1)]||null;a.insertBefore(e,r)}else a.appendChild(e);return a},n.addScriptToDOM=function(e,t,i){if("string"!=typeof e||!t||!document)return!1;var a=i||document.createElement("script");a.type="text/javascript";var r=n.addTagSafely(a,t);return!!r&&(a.src=e,r)},n.expandCachebuster=function(t){return t.replace("[MOAT_CB]",""+(new e).getTime())},n.createXMLcompanionNode=function(e){if(!e||0===e.length)return"";for(var t,i,n,a,r,s,o,d,l,u=document.implementation.createDocument(null,"CompanionAds",null),p=e.length-1;p>=0;p--){if(t=e[p],i=u.createElementNS("","Companion"),i.setAttributeNS("","width",t.width),i.setAttributeNS("","height",t.height),n=u.createElementNS("","StaticResource"),n.setAttributeNS("","type",t.type),n.appendChild(u.createCDATASection(t.staticResource)),i.appendChild(n),t.companionClickThroughURLTemplate&&(a=u.createElementNS("","CompanionClickThrough"),a.appendChild(u.createCDATASection(t.companionClickThroughURLTemplate)),i.appendChild(a)),t.trackingEvents&&t.trackingEvents.creativeView){r=u.createElementNS("","TrackingEvents"),s=t.trackingEvents.creativeView;for(var c=s.length-1;c>=0;c--)o=s[c],d=u.createElementNS("","Tracking"),d.setAttributeNS("","event","creativeView"),d.appendChild(u.createCDATASection(o)),r.appendChild(d);i.appendChild(r)}u.documentElement.appendChild(i)}return l=new XMLSerializer,l.serializeToString(u)},n.emptyObj={},n.isArray=function(e){try{return"[object Array]"===n.emptyObj.toString.call(e)}catch(e){return!1}},n.isFunction=function(e){try{return"[object Function]"===n.emptyObj.toString.call(e)}catch(e){return!1}},n.isNumber=function(e){try{return"[object Number]"===n.emptyObj.toString.call(e)}catch(e){return!1}},n.timeouts=[],n.loops={},n.makeSafe=function(t,n,a){var r=!1;return function(){try{return n?a?t.apply(a,arguments):t.apply(this,arguments):t.apply(null,arguments)}catch(t){if(!r){r=!0;var s,o,d=t.name+" in makeSafe: "+t.message+", stack="+t.stack;try{s=i.qs.level1+"%3A"+i.qs.level2+"%3A"+i.qs.level3+"%3A"+i.qs.level4}catch(e){s="data%3Adata%3Adata%3Adata"}try{o=i.qs.vast}catch(e){o="-"}var l="//pixel.moatads.com/pixel.gif?e=24&d="+s+"&i="+encodeURIComponent("FREEWHEEL1")+"&ac=1&k="+encodeURIComponent(d)+"&ar="+encodeURIComponent("964d7b8-clean")+"&j="+encodeURIComponent(document.referrer)+"&zMoatVast="+o+"&cs="+(new e).getTime();(new Image).src=l,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["AdError"]})}}}},n.setSafeTimeout=function(e,t){e=n.makeSafe(e);var i;return window&&window.setTimeout&&(i=window.setTimeout(e,t),n.timeouts.push(i)),i},n.setSafeLoop=function(t,i,a){if(n.isFunction(t)&&n.isArray(i)&&n.isNumber(a)){var r=(new e).getTime()+"";n.loops[r]&&window.clearTimeout(n.loops[r].tid),n.loops[r]={},n.loops[r].callback=n.makeSafe(t,i),n.loops[r].interval=a,n.loops[r].tid=n.setSafeTimeout(n.runLoop(r),a),t=null,i=null,a=null,r=null}},n.runLoop=function(e){return function(){if(!n.loops||!n.loops[e])return!1;var t=n.loops[e].callback,i=t.call(null);if("boolean"==typeof i&&i===!1)return window.clearTimeout(n.loops[e].tid),n.loops[e]=!1,!1;n.loops[e].tid=n.setSafeTimeout(n.runLoop(e),n.loops[e].interval),i=null,e=null}},n.objectToQueryString=function(e,t){var i="";for(var n in e)e.hasOwnProperty(n)&&(i+="&"+n+"="+e[n]);if(t)var i=encodeURI(i);return i.slice(1)},n.addListener=function(e,t,i,a){var r,s=this.makeSafe(i);if(r=e.addEventListener?{name:"addEventListener",evtPrefix:""}:{name:"attachEvent",evtPrefix:"on"},e&&r.name&&e[r.name])try{e[r.name](r.evtPrefix+t,s,!1)}catch(e){}a!==!1&&(n.safeCallbacks[t+a]=s)},n.removeListener=function(e,t,i,a){var r,s=t+a;if(!e)return delete n.safeCallbacks[s],!1;try{e.removeEventListener;e.detachEvent}catch(e){return delete n.safeCallbacks[s],!1}i=a!==!1?n.safeCallbacks[s]:i,r=e.removeEventListener?{name:"removeEventListener",evtPrefix:""}:{name:"detachEvent",evtPrefix:"on"};try{e[r.name](r.evtPrefix+t,i,!1)}catch(e){}delete n.safeCallbacks[s]},n.getDocAndWinOfEl=function(e){var t,i;try{t=e.ownerDocument,i=t&&(t.defaultView||t.parentWindow)}catch(e){}return{elDoc:t,elWin:i}},n},a=function(){var e=function(){this.availableResources=["StaticResource","IFrameResource","HTMLResource"],this.availableTypesMap={"image/gif":"img","image/jpeg":"img","image/png":"img","application/x-javascript":"js","application/x-shockwave-flash":"swf"},this.availableTypes=["swf","img"]};return e.prototype.loadCompanion=function(e,n,a,r,s,o,d,l){function u(e,t,i,n){function a(e){var t=[],i=e.getElementById(o);i&&t.push(i);for(var n=0,a=f.availableResources.length;n<a;n++){var r;if("StaticResource"==f.availableResources[n])for(var s=0,d=f.availableTypes.length;s<d;s++){var l=e.getElementById(o+"_"+f.availableResources[n]+"_"+f.availableTypes[s]);l&&t.push(l)}else r=e.getElementById(o+"_"+f.availableResources[n]);r&&t.push(r)}return t.length>0&&t}function r(e){if(!e||0==e.length)return!1;if(1==e.length)return e[0];for(var t=0,a=e.length;t<a;t++)if(n){if(e[t].id===o+"_"+i+"_"+n)return e[t]}else if(e[t].id===o+"_"+i)return e[t];return!1}var s,o="moatCompanionDiv_"+e+"x"+t;try{s=r(a(document))||r(a(window.top.document))}catch(e){}if(s)return s;var d=[];try{for(var l=window.frames,u=0,p=l.length;u<p;u++){try{var c=a(l[u].document)}catch(e){}c&&(d=d.concat(c))}}catch(e){}return(s=r(d))||!1}function p(e,i,n,a,r,s,o,d){d=d||[];for(var l="",u=0;u<d.length;u++)l+='<img src="'+d[u]+'" style="display:none" width="1" height="1">';if("StaticResource"===r){if("img"==s){var p='<img src="'+i+'" width="'+n+'" height="'+a+'">';l+=o?'<a href="'+o+'" target="_blank">'+p+"</a>":p}if("swf"==s){var c=t.floor(1e7*t.random());l+='<object type="application/x-shockwave-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/sho ckwave/cabs/flash/swflash.cab#version=8,0,0,0" width="'+n+'" height="'+a+'" id="companion'+(c-1)+'"><param name="allowScriptAccess" value="always" /><param name= "movie" value="'+i+'" />'+(o?'<param name="FlashVars" value="clickTag='+encodeURIComponent(o)+'" />':"")+'<param name="wmode" value="opaque" /><embed type="application/x-shockwave-flash" src="'+i+'" '+(o?'flashvars="clickTag='+encodeURIComponent(o)+'" ':"")+'wmode="opaque" width="'+n+'" height="'+a+'" id="companion'+c+'"name="companion'+c+'"allowscriptaccess="always" /></object>'}}return"IFrameResource"===r&&(l+="<iframe style='border:0px; padding:0px; margin:0px;' width='"+n+"' height='"+a+"' frameborder='no' scrolling='no' marginheight='0' marginwidth='0' src='"+i+"'></iframe>"),"HTMLResource"===r&&(l+=i,e&&(n&&(e.style.width=n+"px"),a&&(e.style.height=a+"px"))),l}function c(){if(g)return!0;try{var t=n,o=u(a,r,e,t);if(!o)return!1;if("DIV"!==o.nodeName){var c=o;c.id="";var h=i.Util.getParentNode(c);if(!h)return!1;o=document.createElement("div"),i.Util.addTagSafely(o,h)}else o.id="";o.innerHTML=p(o,s,a,r,e,t,d,l)}catch(e){return!1}return!0}function h(t){try{var i=n,o=p(null,s,a,r,e,i,d,l);t.postMessage("zMoatAdContent#"+o,"*")}catch(e){return!1}return!0}function v(e,t,i,n){i>=n||e()||(i++,setTimeout(function(){v(e,t,i,n)},t))}function m(e){if(!g){var t,i,n;"string"==typeof e.data&&(t=e.data.match(/^zMoatPlaceholder#([0-9]+)x([0-9]+)$/))&&(i=t[1],n=t[2],i==a&&n==r&&(g=h(e.source)))}}var f=this;n=f.availableTypesMap[n];var g=!1,A=c();return A||(setTimeout(function(){v(c,500,0,10)},500),function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}(window,"message",m)),A},e},r=function(){var n,a=0,r=t.floor(t.random()*t.pow(10,8));n="VPAID2JSWRAPPER1",i.Queue.subscribe("vpaid-events",function(t){var s={};s.e=32,s.q=a++,s.g=a,s.d=encodeURIComponent(i.qs.pcode+":"+t.type+":unknown:unknown"),s.i=n,s.t=i.startTime,s.m=(new e).getTime()-i.startTime,s.ar=encodeURIComponent("964d7b8-clean"),s.de=r;var o=i.Util.objectToQueryString(s,!1),d="//pixel.moatads.com/pixel.gif?"+o+"&bq=8&o=3&ac=1&cs=0";(new Image).src=d})},s=function(){i.Queue.subscribe("vpaid-events",function(e){var t=e.type,n=e.args;if(i.playerProvidedEventCallbacks[t])for(var a=i.playerProvidedEventCallbacks[t],r=a.length-1;r>=0;r--){var s=a[r],o=s.fn,d=s.listenerScope;d||(d=null);try{o.apply(d,n)}catch(e){}}})},o=function(){var e=function(e,t){i.moatTag=this,this.pcode=e,this.ids=t,this.moatapi,this.eventBuffer=[],this.init()};return e.prototype.init=function(){var e=this;i.Queue.subscribe("moat-tag",function(t){e.initMoatTracking(t.videoElement,t.duration)}),i.Queue.subscribe("vpaid-events",function(t){var n={type:t.type,adVolume:i.ad.getAdVolume()};if(t.type===i.VPAIDevents.AdDurationChange&&(n.duration=t.args[0],n.confirmed=!0),"moat_DURATION_DEBUG"===t.type){if(!t.args||t.length<2)return;n[t.args[0]]=t.args[1]}if(e.moatapi&&"function"==typeof e.moatapi.dispatchEvent){if(e.eventBuffer&&e.eventBuffer.length>0)for(var a=e.eventBuffer.length-1;a>=0;a--){var r=e.eventBuffer[a];e.moatapi.dispatchEvent(r)}e.eventBuffer=!1,e.moatapi.dispatchEvent(n)}else e.eventBuffer&&e.eventBuffer.push(n)}),i.Queue.subscribe("moatapi-events",function(t){e.moatapi&&e.moatapi.adData&&e.moatapi.adData.ids&&!e.moatapi.adData.ids[t.property]?e.moatapi.adData.ids[t.property]=t.value:e.ids&&!e.ids[t.property]&&(e.ids[t.property]=t.value)}),i.Queue.subscribe("moatvideo-events",function(e){e.type&&"AdClicked"===e.type&&i.underlyingAsset&&i.underlyingAsset.onAdClickHandler&&i.underlyingAsset.onAdClickHandler()})},e.prototype.initMoatTracking=function(e,n){var a=document.createElement("script"),r=[],s={adData:{ids:this.ids,duration:n},dispatchEvent:function(e){this.sendEvent?(r&&(r.push(e),e=r,r=!1),this.sendEvent(e)):r&&r.push(e)},publishToWrapper:function(e){i.Queue.publish("moatvideo-events",e)}},o="_moatApi"+t.floor(1e8*t.random()),d=i.Util.getDocAndWinOfEl(e),l=(d.elDoc,d.elWin);if(!l)return!1;this.moatapi=l[o]=s,a.type="text/javascript",e&&e.insertBefore(a,e.childNodes[0]||null);var u="#"+o;a.src="https://z.moatads.com/"+this.pcode+"/moatvideo.js"+u},e},d=function(){var e=function(e){return i.version},t=function(e,t,n,a,r,s){if(this._width=e,this._height=t,this._viewMode=n||"normal",this._desiredBitrate=a,this._creativeData=r,this._environmentVars=s,this._slot=s.slot,this._videoSlot=s.videoSlot,"string"==typeof this._videoSlot.nodeName&&"number"==typeof this._videoSlot.nodeType?this._domElToTrack=this._videoSlot:this._domElToTrack=this._slot,i&&i.moatTag&&i.moatTag.ids&&this._domElToTrack){var t="number"==typeof this._domElToTrack.offsetHeight?this._domElToTrack.offsetHeight:"-",e="number"==typeof this._domElToTrack.offsetWidth?this._domElToTrack.offsetHeight:"-";i.moatTag.ids.origSize=e+"x"+t}if(this._domElToTrack&&this._domElToTrack.parentNode&&this._domElToTrack.parentNode.id&&"fw-pdk-plugin-video-display-base"==this._domElToTrack.parentNode.id){var o=this._domElToTrack.offsetHeight,d=this._domElToTrack.offsetWidth;("number"==typeof o&&!isNaN(o)&&0==o||"number"==typeof d&&!isNaN(d)&&0==d)&&this._height&&this._width&&this._domElToTrack.style&&(this._domElToTrack.style.height=this._height+"px",this._domElToTrack.style.width=this._width+"px")}i.qs.vast,i.qs.asset;if(i.qs.vast){i.VastLoader=c();(new i.VastLoader).request(i.qs.vast)}else if(i.qs.asset){i.VideoPlayer=h();var l=new i.VideoPlayer;i.underlyingAsset=l;var u=[{fileURL:i.qs.asset,mimeType:"video/mp4",height:this._height,width:this._width,bitrate:this._desiredBitrate}];l.init(u,!1,i.qs.clickTag,!1)}else i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["AdError"]})},n=function(e,t,n){var a=i.playerProvidedEventCallbacks;a[t]?a[t].push({fn:e,listenerScope:n}):a[t]=[{fn:e,listenerScope:n}]},a=function(e,t){var n=i.playerProvidedEventCallbacks[t];if(n)for(var a=n.length-1;a>=0;a--){var r=n[a];e===r.fn&&n.splice(a,1)}},r=function(e,t,n){i.underlyingAsset&&i.underlyingAsset.resizeAd(e,t,n)},s=function(){i.underlyingAsset&&i.underlyingAsset.startAd()},o=function(){i.underlyingAsset&&i.underlyingAsset.stopAd()},d=function(){i.underlyingAsset&&i.underlyingAsset.pauseAd()},l=function(){i.underlyingAsset&&i.underlyingAsset.resumeAd()},u=function(){i.underlyingAsset&&i.underlyingAsset.expandAd()},p=function(){i.underlyingAsset&&i.underlyingAsset.collapseAd()},v=function(){i.underlyingAsset&&i.underlyingAsset.skipAd()},m=function(e){isNaN(e)===!1&e>=0&&e<=1&&i.underlyingAsset&&i.underlyingAsset.setAdVolume(e)},f=function(){return i.underlyingAsset?i.underlyingAsset.getAdRemainingTime():-2},g=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdWidth()},A=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdIcons()},y=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdSkippableState()},_=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdLinear()},k=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdCompanions()},C=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdExpanded()},T=function(){if(i.underlyingAsset)return i.underlyingAsset.getAdHeight()},b=function(){return i.underlyingAsset?i.underlyingAsset.getAdVolume():1},E=function(){return i.underlyingAsset?i.underlyingAsset.getAdDuration():-2},S=function(){this._width,this._height,this._viewMode,this._desiredBitrate,this._creativeData,this._environmentVars,this._slot,this._videoSlot,this._domElToTrack};return S.prototype={initAd:i.Util.makeSafe(t,!0),collapseAd:i.Util.makeSafe(p,!0),constructor:i.Util.makeSafe(constructor,!0),expandAd:i.Util.makeSafe(u,!0),getAdCompanions:i.Util.makeSafe(k,!0),getAdDuration:i.Util.makeSafe(E,!0),getAdExpanded:i.Util.makeSafe(C,!0),getAdHeight:i.Util.makeSafe(T,!0),getAdIcons:i.Util.makeSafe(A,!0),getAdLinear:i.Util.makeSafe(_,!0),getAdRemainingTime:i.Util.makeSafe(f,!0),getAdSkippableState:i.Util.makeSafe(y,!0),getAdVolume:i.Util.makeSafe(b,!0),getAdWidth:i.Util.makeSafe(g,!0),handshakeVersion:i.Util.makeSafe(e,!0),pauseAd:i.Util.makeSafe(d,!0),resizeAd:i.Util.makeSafe(r,!0),resumeAd:i.Util.makeSafe(l,!0),setAdVolume:i.Util.makeSafe(m,!0),skipAd:i.Util.makeSafe(v,!0),startAd:i.Util.makeSafe(s,!0),stopAd:i.Util.makeSafe(o,!0),subscribe:i.Util.makeSafe(n,!0),unsubscribe:i.Util.makeSafe(a,!0)},S},l=function(){var e={"vpaid-events":[],"moat-tag":[],"internal-events":[],"skip-button":[],"moatapi-events":[],"moatvideo-events":[]};return{subscribe:function(t,i){if(e[t]){var n=e[t].push(i)-1;return{remove:function(){delete e[t][n]}}}},publish:function(t,i){if(e[t])for(var n=e[t],a=n.length-1;a>=0;a--){var r=n[a];"function"==typeof r&&r.call(null,i)}}}},u=function(){var e=function(e){this.skipContainer,this.textContainer,this.iconContainer,this.skipIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABGdBTUEAALGPC/xhBQAAAKBJREFUOBFjYBgFsBD4////TCBmg/Hx0UB1FUD8CYi7cKoDSoLAMSCWxKkIKgFU8xSkGAh+4VQLkQeTz4CkJU6FQAmg/CuYepzqYAqg9E8gnYZLMVCOZANh5mMNV0oMBBmMEa6UGggyFCVckQ1kwhUuVBcHOQMHoKqXqRYpVE02KBGALWyBQUN0OsQILxwGEpX1sIYXDgNhhUM3NvlhLgYAYuCVi7Jf+AUAAAAASUVORK5CYII=",this.init(e)};return e.prototype.init=function(e){this.createContainer(e),this.createTextContainer(),this.createIconContainer(),e.appendChild(this.skipContainer),this.updateButtonTextSubscription=i.Queue.subscribe("skip-button",this.updateButtonText.bind(this)),i.Queue.subscribe("vpaid-events",this.addClickHandler.bind(this))},e.prototype.createContainer=function(e){this.skipContainer=document.createElement("div"),this.skipContainer.style.background="rgba(0,0,0,0.8)",this.skipContainer.style.color="#ffffff",this.skipContainer.style.fontSize="11px",this.skipContainer.style.fontFamily="arial,sans-serif",this.skipContainer.style.position="absolute",this.skipContainer.style.textAlign="center",this.skipContainer.style.right="0px",this.skipContainer.style.bottom="10%",this.skipContainer.style.padding="2%"},e.prototype.createTextContainer=function(){this.textContainer=document.createElement("span"),this.textContainer.style.verticalAlign="middle",this.skipContainer.appendChild(this.textContainer)},e.prototype.createIconContainer=function(){this.iconContainer=document.createElement("img"),this.iconContainer.style.display="none",this.iconContainer.style.verticalAlign="middle",this.iconContainer.setAttribute("src",this.skipIconUrl),this.skipContainer.appendChild(this.iconContainer)},e.prototype.updateButtonText=function(e){e.timeLeft>0?this.textContainer.innerHTML="you can skip this ad in "+e.timeLeft:(this.textContainer.innerHTML="Skip Ad",this.textContainer.style.fontSize="18px",this.iconContainer.style.display="inline",this.updateButtonTextSubscription.remove())},e.prototype.skipAd=function(){i.underlyingAsset&&i.underlyingAsset.skipAd()},e.prototype.addClickHandler=function(e){e.type===i.VPAIDevents.AdSkippableStateChange&&i.Util.addListener(this.skipContainer,"click",this.skipAd,"skipClickHandlerFn")},e.prototype.cleanUp=function(){this.skipContainer.parentNode.removeChild(this.skipContainer),this.skipContainer=null,this.textContainer=null,this.iconContainer=null},e},p=function(){function e(e,t){return t&&e&&e[t]?e[t]:[]}var t={AdSkipped:"skip",AdStarted:"creativeView",AdVideoStart:"start",AdVideoFirstQuartile:"firstQuartile",AdVideoMidpoint:"midpoint",AdVideoThirdQuartile:"thirdQuartile",AdVideoComplete:"complete",AdUserAcceptInvitation:"acceptInvitation",AdUserMinimize:"collapse",AdUserClose:"close",AdPaused:"pause",AdPlaying:"resume",AdError:"error"};return p=function(e,t,n,a,r,s){this.trackingEvents=e,this.impressionURLs=t,this.scrURLS=i.Util.getScrUrls(),this.errorURLs=n,this.clicktrackingURLs=a,this.customTrackingEvents=s,this.lastVolume=!1,this.surveys=r,this.init()},p.prototype.init=function(){var n=this;i.Queue.subscribe("internal-events",function(e){n.lastVolume=e.volume}),i.Queue.subscribe("vpaid-events",function(a){var r,s,o=!1;switch(a.type){case i.VPAIDevents.AdImpression:n.handleSurveys(),r=n.impressionURLs,o=!0;break;case i.VPAIDevents.AdVolumeChange:var d,l=i.underlyingAsset&&i.underlyingAsset.getAdVolume();"number"==typeof n.lastVolume&&"number"==typeof l&&(0===l&&n.lastVolume>0?d="mute":l>0&&0===n.lastVolume&&(d="unmute")),n.lastVolume=l,d&&(r=n.trackingEvents[d]);break;case i.VPAIDevents.AdClickThru:r=n.clicktrackingURLs;break;case i.VPAIDevents.AdError:r=n.errorURLs;break;default:var u=t[a.type];r=e(n.trackingEvents,u).concat(e(n.customTrackingEvents,u))}if(r)for(var p=r.length-1;p>=0;p--)if("string"==typeof(s=r[p]))try{(new Image).src=s}catch(e){}if(o)for(var c=n.scrURLS,h=c.length-1;h>=0;h--)i.Util.addScriptToDOM(c[h],i.ad._domElToTrack)})},p.prototype.handleSurveys=function(){if(this.surveys&&i.ad._domElToTrack)for(var e,t,n,a=i.ad._domElToTrack,r=this.surveys,s=!1,o=0;o<r.length;o++)if(n=r[o],"js"===function(e){var t="";if(e.type){var i=e.type.split("/");t="javascript"===i[i.length-1]?"js":"pixel"}else{var n=e.url.match(/([^\/&?#]+)(?:$|#|\?)/i),a=n&&2===n.length&&n[1],r=a&&a.split(".");t=r&&r[r.length-1]}return"js"===t?"js":"pixel"}(n)){if(!s){var d=i.Util.getDocAndWinOfEl(a);e=d.elDoc,t=d.elWin,s=!0}if(!t)continue;var l=e.createElement("script");l.src=n.url,l.type="text/javascript";var u=i.Util.getParentNode(a),p=u||a;p.insertBefore(l,p.childNodes[0]||null)}else(new Image).src=n.url},p},c=function(){function e(e){function t(e){if(0!==e.children.length)for(var i=e.children,a=0;a<i.length;a++){if("Tracking"===i[a].name){var r=i[a].attributes.event,s=i[a].value;n[r]=[s]}t(i[a])}}var i=e.extensions,n={};for(var a in i)t(i[a]);return n}var t=function(){};return t.prototype.request=function(e){var t=this,n=!1;e&&e.match("ad.doubleclick.net")&&(n=!0),DMVAST.client.get(e,{withCredentials:n},function(e){e?t.extractStuff(e):i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["no VAST tag response"]})})},t.prototype.extractStuff=function(t){var n=["progressive"];if(t&&t.ads&&0!==t.ads.length){var r={linearCreatives:[],companions:[]},s=t.ads[0];s.creativeId&&i.Queue.publish("moatapi-events",{property:"zMoatCreativeId",value:s.creativeId});for(var o=s.creatives,d=o.length-1;d>=0;d--){var l=o[d];switch(l.type){case"linear":for(var u={duration:l.duration,adParameters:l.adParameters,trackingEvents:l.trackingEvents,clickthroughURL:l.videoClickThroughURLTemplate,clicktrackingURLs:l.videoClickTrackingURLTemplates,vpaid:[],videos:[],skipoffset:l.skipDelay},c=l.mediaFiles,m=c.length-1;m>=0;m--){var f=c[m],g=f.mimeType.toLowerCase(),A=f.deliveryType.toLowerCase();"VPAID"===f.apiFramework&&("application/javascript"===g||"application/x-javascript"===g)&&n.indexOf(A)>-1&&u.vpaid.push(f),n.indexOf(A)>-1&&u.videos.push(f)}r.linearCreatives.push(u);break;case"companion":for(var y=l.variations.length-1;y>=0;y--)r.companions.push(l.variations[y])}}var _,k=r.linearCreatives.length;if(1===k)_=r.linearCreatives[0];else for(var d=k-1;d>=0;d--){var C=r.linearCreatives[d];if(C.videos.length>0||C.vpaid.length>0){_=C;break}}if(_||i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["No suitable assets found"]}),_.customTrackingEvents=e(s),i.TrackerManager=p(),new i.TrackerManager(_.trackingEvents,s.impressionURLTemplates,s.errorURLTemplates,_.clicktrackingURLs,s.surveys,_.customTrackingEvents),r.companions.length>0){i.CompanionLoader=a();for(var T=new i.CompanionLoader,b=r.companions.length-1;b>=0;b--){var E,S,V=r.companions[b];V.htmlResource?(E="HTMLResource",S=V.htmlResource):V.iframeResource?(E="IFrameResource",S=V.iframeResource):V.staticResource&&(E="StaticResource",S=V.staticResource),T.loadCompanion(E,V.type,V.width,V.height,S,!1,V.companionClickThroughURLTemplate,V.trackingEvents.creativeView)}}if(_.vpaid.length>0){i.VpaidPlayer=v();var w=new i.VpaidPlayer;return void w.init(_.vpaid[0],_.adParameters,_.duration,r.companions)}if(_.videos.length>0){i.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["mediafile","video"]}),i.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["vast-duration",_.duration]}),i.VideoPlayer=h();var w=new i.VideoPlayer;return i.underlyingAsset=w,void w.init(_.videos,_.duration,_.clickthroughURL,r.companions,_.skipoffset)}i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["No suitable assets found"]})}},t},h=function(){var n=function(){this._videoEl,this._adIsStarted,this._firstQuartileTime,this._firstQuartileReached,this._midpointTime,this._midpointReached,this._thirdQuartileTime,this._thirdQuartileReached,this._videoIsCompleted,this._adIsPlaying=!1,this._lastViewMode,this._originalSlotCursorStyle,this._originalVideoSlotCursorStyle,this._pauseAdOnClickThru=!0,this._adIsPausedViaClickThru=!1,this._clickthroughURL,this._lastClickThruTime,this._skipoffset,this._cleanupCalled,this._durationConfirmed=!1,this._adLinear=!0,this._adWidth=i.ad._width,this._adHeight=i.ad._height,this._adExpanded=!1,this._adSkippableState=!1,this._adRemainingTime=-2,this._adDuration=-2,this._adVolume=1,this._adCompanions="",this._adIcons=!1,this._skipButtonModule=u(),this._skipButtonManager};return n.prototype.init=function(e,t,n,a,r){this._videoEl=i.ad._videoSlot,this._adDuration=this._adRemainingTime=t,this._mediaFile=this.pickMediaFile(e),this._skipoffset=r,this._skipoffset||(isNaN(Number(i.qs.skip))===!1?this._skipoffset=Number(i.qs.skip):isNaN(Number(i.qs.zMoatSkip))===!1&&(this._skipoffset=Number(i.qs.zMoatSkip)));var s=i&&i.ad&&i.ad._slot,o=i&&i.ad&&i.ad._videoSlot;s&&s.style&&(this._originalSlotCursorStyle=s.style.cursor,s.style.cursor="pointer"),o&&o.style&&(this._originalVideoSlotCursorStyle=o.style.cursor,o.style.cursor="pointer"),void 0!==this._videoEl.volume&&"number"==typeof this._videoEl.volume&&(this._adVolume=this._videoEl.volume),i.Queue.publish("internal-events",{volume:this._adVolume}),this._clickthroughURL=n,this._lastViewMode=i.ad._viewMode,this._adCompanions=i.Util.createXMLcompanionNode(a),this.onAdClickHandler=this.onAdClick(),this.onErrorHandler=this.videoErrorHandlerFn(),this.createListeners(),"1"===i.qs.noctp&&(this._pauseAdOnClickThru=!1),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdLoaded}),this._adDuration&&(this.determineQuartiles(),i.Queue.publish("moat-tag",{videoElement:i.ad._domElToTrack,duration:this._adDuration}))},n.prototype.resizeAd=function(e,t,n,a){"string"==typeof n&&(n=n.toLowerCase());var r=n&&"fullscreen"===n,s="number"==typeof e&&"number"==typeof t&&!isNaN(e)&&!isNaN(t),o=!r&&!!s;!r&&!s||o&&!this._videoEl||(o&&(this._adHeight=t,this._adWidth=e,this._videoEl.width=e,this._videoEl.height=t),a&&i.ad._slot&&(i.ad._slot.style.width=e+"px",i.ad._slot.style.height=t+"px"),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdSizeChange}))},n.prototype.startAd=function(){if(!this._adIsStarted){if(this.setVideoElSrc(this._mediaFile),i.ad&&i.ad._slot){var e="function"==typeof window.getComputedStyle&&window.getComputedStyle(i.ad._slot),t=e||i.ad._slot.style||i.ad._slot.currentStyle;t&&i.ad._width&&i.ad._height&&("0px"==t.width&&i.ad._width>0||"0px"==t.height&&i.ad._height>0)&&this.resizeAd(i.ad._width,i.ad._height,i.ad._viewMode||"normal",!0)}"number"==typeof this._skipoffset&&(this._skipButtonManager=new this._skipButtonModule(i.ad._slot)),this._videoEl.load(),this._videoEl.play(),this._adIsStarted=!0,this._adIsPlaying=!0,this._adIsPausedViaClickThru=!1,this.timer(),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdStarted}),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdImpression}),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVideoStart})}},n.prototype.stopAd=function(){this.cleanUp(),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdStopped})},n.prototype.pauseAd=function(){1==this._adIsPlaying&&(this._videoEl.pause(),this._adIsPlaying=!1,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdPaused}))},n.prototype.resumeAd=function(){0==this._adIsPlaying&&(this._videoEl.play(),this._adIsPlaying=!0,this._adIsPausedViaClickThru=!1,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdPlaying}))},n.prototype.skipAd=function(){this.cleanUp(),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdSkipped});var e=function(){i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdStopped})};i.Util.setSafeTimeout(e,400)},n.prototype.getAdLinear=function(){return this._adLinear},n.prototype.getAdCompanions=function(){return this._adCompanions},n.prototype.getAdExpanded=function(){return this._adExpanded},n.prototype.getAdHeight=function(){return this._adHeight},n.prototype.getAdWidth=function(){return this._adWidth},n.prototype.getAdVolume=function(){var e=1,t=this._videoEl.volume,i=this._adVolume;return this._videoEl.muted?e=0:"number"!=typeof t||isNaN(t)?"number"!=typeof i||isNaN(i)||(e=i):e=t,e},n.prototype.setAdVolume=function(e){this._adVolume=e,"number"==typeof this._videoEl.volume&&(this._videoEl.volume=e),i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVolumeChange})},n.prototype.getAdRemainingTime=function(){return this._adDuration-this._videoEl.currentTime},n.prototype.getAdDuration=function(){return this._adDuration},n.prototype.getAdIcons=function(){return this._adIcons},n.prototype.getAdSkippableState=function(){return this._adSkippableState},n.prototype.setVideoElSrc=function(e){e&&"string"==typeof e.fileURL&&e.fileURL.length?this._videoEl.src=e.fileURL:i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["invalid mediaFile or mediaFile fileURL"]})},n.prototype.pickMediaFile=function(e){for(var n=this._adWidth*this._adHeight,a=[],r=e.length-1;r>=0;r--){var s=e[r];""!==this._videoEl.canPlayType(s.mimeType)&&a.push({sizeDiff:t.abs(n-s.width*s.height),bitrate:s.bitrate,mediaFile:s})}0===a.length&&i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["AdError"]}),a.sort(function(e,t){var i=e.sizeDiff-t.sizeDiff;return 0!==i?i:t.bitrate-e.bitrate});for(var r=a.length-1;r>=0;r--){var o=a[r];if("probably"===this._videoEl.canPlayType(o.mediaFile.mimeType))return o.mediaFile}for(var r=a.length-1;r>=0;r--){var o=a[r];if("maybe"===this._videoEl.canPlayType(o.mediaFile.mimeType))return o.mediaFile}},n.prototype.onAdClick=function(){return function(t){var n=(new e).getTime();if(void 0===this._lastClickThruTime||n-this._lastClickThruTime>100){if(this._lastClickThruTime=n,this._pauseAdOnClickThru===!0&&this._adIsPausedViaClickThru===!1)this.pauseAd(),this._adIsPausedViaClickThru=!0;else if(this._adIsPausedViaClickThru===!0)return void this.resumeAd();i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdClickThru,args:[this._clickthroughURL,null,!0]})}}.bind(this)},n.prototype.videoErrorHandlerFn=function(e){return function(e){i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["AdError"]})}},n.prototype.createListeners=function(){i.Util.addListener(i.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),i.Util.addListener(i.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),i.Util.addListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn")},n.prototype.determineQuartiles=function(){var e=this._adDuration/4;this._firstQuartileTime=0+e,this._midpointTime=this._firstQuartileTime+e,this._thirdQuartileTime=this._midpointTime+e},n.prototype.onConfirmDuration=function(e){if(!this._adDuration&&0!==this._adDuration){if(!i.ad._domElToTrack)return i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["AdError"]}),!1;i.Queue.publish("moat-tag",{videoElement:i.ad._domElToTrack,duration:self._adDuration})}this._adDuration=e,this.determineQuartiles(),this._durationConfirmed=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdDurationChange,args:[e]})},n.prototype.confirmDuration=function(){
if(!this._durationConfirmed){var e=this._videoEl&&this._videoEl.duration;"number"==typeof e&&!isNaN(e)&&e>0&&this.onConfirmDuration(t.round(e))}},n.prototype.timer=function(){var e=function(e){return function(){e.confirmDuration(),e._adDuration&&e.progressWatcher()}}(this);i.Util.setSafeLoop(e,[],500)},n.prototype.progressWatcher=function(){if(this._skipoffset&&this._adSkippableState===!1&&this._videoEl.currentTime>this._skipoffset&&(this._adSkippableState=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdSkippableStateChange})),i.Queue.publish("skip-button",{timeLeft:t.max(t.round(this._skipoffset-this._videoEl.currentTime),0)}),this._adIsStarted&&!this._firstQuartileReached&&this._videoEl.currentTime>this._firstQuartileTime)this._firstQuartileReached=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVideoFirstQuartile});else if(this._adIsStarted&&this._firstQuartileReached&&!this._midpointReached&&this._videoEl.currentTime>this._midpointTime)this._midpointReached=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVideoMidpoint});else if(this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&!this._thirdQuartileReached&&this._videoEl.currentTime>this._thirdQuartileTime)this._thirdQuartileReached=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVideoThirdQuartile});else if(this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&this._thirdQuartileReached&&!this._videoIsCompleted&&(this._videoEl.currentTime>=this._adDuration||this._videoEl.ended)){this.cleanUp(),this._videoIsCompleted=!0,i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdVideoComplete});var e=function(){i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdStopped})};i.Util.setSafeTimeout(e,400)}},n.prototype.cleanUp=function(){this._cleanupCalled||(this._cleanupCalled=!0,i.Util.removeListener(i.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),i.Util.removeListener(i.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),i.Util.removeListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn"),i.ad._slot.style&&(i.ad._slot.style.cursor=this._originalSlotCursorStyle),i.ad._videoSlot.style&&(i.ad._videoSlot.style.cursor=this._originalVideoSlotCursorStyle),"number"==typeof this._skipoffset&&this._skipButtonManager.cleanUp())},n},v=function(){return v=function(){this._iframe,this._adCompanions,this._lastAdVolume,this._adParameters},v.prototype.init=function(e,n,a,r){var s=t.random()+"";if(window["moatstartvpaid"+s]=this.startVPAID.bind(this),window["moatstartvpaiderr"+s]=this.handleError.bind(this),e&&e.fileURL&&e.fileURL.match(/^https?:\/\/(s0\.2mdn\.net|imasdk\.googleapis\.com)/)){var o=function(){window["moatstartvpaid"+s]()},d=function(){window["moatstartvpaiderr"+s]()},l=document.createElement("script");l.type="text/javascript",l.onload=o,l.onerror=d,l.src=e.fileURL,i.Util.addTagSafely(l,document.body)}else{var u=document.createElement("iframe");this._iframe=u,u.style.display="none",document.body.appendChild(u);var p='<html><head><body><script>function startVPAID() {window.parent["moatstartvpaid'+s+'"]();};function errVPAID() {window.parent["moatstartvpaiderr'+s+'"]();};</script><script onerror="errVPAID();" onload="startVPAID();" src="'+e.fileURL+'"></script></body></head></html>';u.contentWindow.moatsrc=p,u.src="javascript:window.moatsrc"}this._adCompanions=r,this._adParameters=n,i.Queue.publish("moat-tag",{videoElement:i.ad._domElToTrack,duration:a})},v.prototype.handleError=function(){i.Queue.publish("vpaid-events",{type:i.VPAIDevents.AdError,args:["no VPAID response"]})},v.prototype.wrapGetAdCompanions=function(){var e=this,t=this._vpaid.getAdCompanions;this._vpaid.getAdCompanions=function(){return e._adCompanions.length>0?i.Util.createXMLcompanionNode(e._adCompanions):t?t.call(e._vpaid):""}},v.prototype.createCallbacks=function(){var e={};for(var t in i.VPAIDevents){var n=function(e){var t=e;return function(){i.Queue.publish("vpaid-events",{type:t,args:arguments})}}(t);e[t]=n}return e},v.prototype.startVPAID=function(){var e,t=this,n=!1,a=0;e=t._iframe?t._iframe.contentWindow:window;var r=function(){if(++a>20||n)return t.handleError(),!1;var r=e.getVPAIDAd&&"function"==typeof e.getVPAIDAd&&e.getVPAIDAd();if(r){t._vpaid=r,n=!0;var s=(r.handshakeVersion(i.version),t.createCallbacks());for(var o in s)r.subscribe(s[o],o);t.wrapGetAdCompanions(),i.underlyingAsset=r;var d={AdParameters:t._adParameters}||i.ad._creativeData||{};r.initAd(i.ad._width,i.ad._height,i.ad._viewMode,i.ad._desiredBitrate,d,i.ad._environmentVars);var l;try{l=r.getAdVolume()}catch(e){l=-1}return i.Queue.publish("internal-events",{volume:l}),!1}};i.Util.setSafeLoop(r,[],100)},v}}(Date,Math)}catch(i){try{var e=i.name+" in global t/c: "+i.message+", stack="+i.stack,t="//pixel.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("FREEWHEEL1")+"&ac=1&k="+encodeURIComponent(e)+"&ar="+encodeURIComponent("964d7b8-clean")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=t}catch(e){}}}();


/**
* Copyright (c) 2013 Olivier Poitrey <rs@dailymotion.com>
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
 
!function(){try{!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.DMVAST=e()}}(function(){return function e(t,i,n){function r(o,a){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i=t[o][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],a(i))return!1;if(r(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,s=new Array(n-1),l=1;l<n;l++)s[l-1]=arguments[l];i.apply(this,s)}else if(o(i)){for(n=arguments.length,s=new Array(n-1),l=1;l<n;l++)s[l-1]=arguments[l];for(u=i.slice(),n=u.length,l=0;l<n;l++)u[l].apply(this,s)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var i;i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],s=i.length,n=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(i)){for(a=s;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){n=a;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],r(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){return e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],2:[function(e,t,i){var n;n=function(){function e(){this.id=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[],this.surveys=[]}return e}(),t.exports=n},{}],3:[function(e,t,i){var n,r,s;r=e("./parser"),s=e("./util"),n=function(){function e(){}return e.cappingFreeLunch=0,e.cappingMinimumTimeInterval=0,e.options={withCredentials:!1,timeout:0},e.get=function(e,t,n){var s,o,a;return o=+new Date,s=i.extend=function(e,t){var i,n;for(i in t)n=t[i],e[i]=n;return e},n||("function"==typeof t&&(n=t),a={}),a=s(this.options,t),this.totalCallsTimeout<o?(this.totalCalls=1,this.totalCallsTimeout=o+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls?void n(null):o-this.lastSuccessfullAd<this.cappingMinimumTimeInterval?void n(null):r.parse(e,a,function(e){return function(e){return n(e)}}(this))},function(){var t,i;i=s.storage,t=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(n){t(e,n,{get:function(){return i.getItem(n)},set:function(e){return i.setItem(n,e)},configurable:!1,enumerable:!0})}),null==e.totalCalls&&(e.totalCalls=0),null==e.totalCallsTimeout&&(e.totalCallsTimeout=0)}(),e}(),t.exports=n},{"./parser":11,"./util":18}],4:[function(e,t,i){var n;n=function(){function e(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}}return e}(),t.exports=n},{}],5:[function(e,t,i){var n,r,s,o,a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=function(){function e(){this.trackingEvents={}}return e}(),s=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null}return l(t,e),t}(n),o=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(n),r=function(e){function t(){this.type="companion",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(n),t.exports={VASTCreativeLinear:s,VASTCreativeNonLinear:o,VASTCreativeCompanion:r}},{}],6:[function(e,t,i){var n;n=function(){function e(){this.attributes={},this.children=[]}return e}(),t.exports=n},{}],7:[function(e,t,i){var n;n=function(){function e(e,t){this.name=e,this.value=t,this.attributes={},this.children=[]}return e}(),t.exports=n},{}],8:[function(e,t,i){t.exports={client:e("./client"),tracker:e("./tracker"),parser:e("./parser"),util:e("./util")}},{"./client":3,"./parser":11,"./tracker":14,"./util":18}],9:[function(e,t,i){var n;n=function(){function e(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}return e}(),t.exports=n},{}],10:[function(e,t,i){var n;n=function(){function e(){this.id=null,this.width=0,this.height=0,this.minSuggestedDuration="00:00:00",this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null}return e}(),t.exports=n},{}],11:[function(e,t,i){var n,r,s,o,a,l,u,h,c,p,d,f,m,v,g,T=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1};r=e("./urlhandler"),m=e("./response"),s=e("./ad"),o=e("./extension"),a=e("./extensionchild"),g=e("./util"),h=e("./creative").VASTCreativeLinear,u=e("./creative").VASTCreativeCompanion,c=e("./creative").VASTCreativeNonLinear,p=e("./mediafile"),l=e("./companionad"),d=e("./nonlinear"),v=e("./survey"),n=e("events").EventEmitter,f=function(){function e(){}var t;return t=[],e.addURLTemplateFilter=function(e){"function"==typeof e&&t.push(e)},e.removeURLTemplateFilter=function(){return t.pop()},e.countURLTemplateFilters=function(){return t.length},e.clearUrlTemplateFilters=function(){return t=[]},e.parse=function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),this._parse(e,null,t,function(e,t){return i(t)})},e.vent=new n,e.track=function(e,t){return this.vent.emit("VAST-error",t),g.track(e,t)},e.on=function(e,t){return this.vent.on(e,t)},e.once=function(e,t){return this.vent.once(e,t)},e._parse=function(e,i,n,s){var o,a,l;for(s||("function"==typeof n&&(s=n),n={}),a=0,l=t.length;a<l;a++)o=t[a],e=o(e);return null==i&&(i=[]),i.push(e),r.get(e,n,function(t){return function(r,o){var a,l,u,h,c,p,d,f,v,g,y;if(null!=r)return s(r);if(c=new m,null==(null!=o?o.documentElement:void 0)||"VAST"!==o.documentElement.nodeName)return s();for(g=o.documentElement.childNodes,p=0,f=g.length;p<f;p++)h=g[p],"Error"===h.nodeName&&c.errorURLTemplates.push(t.parseNodeText(h));for(y=o.documentElement.childNodes,d=0,v=y.length;d<v;d++)h=y[d],"Ad"===h.nodeName&&(a=t.parseAdElement(h),null!=a?c.ads.push(a):t.track(c.errorURLTemplates,{ERRORCODE:101}));for(l=function(e){var i,n,r;if(null==e&&(e=!1),c){for(r=c.ads,i=0,n=r.length;i<n;i++)if(a=r[i],null!=a.nextWrapperURL)return;return 0===c.ads.length&&(e||t.track(c.errorURLTemplates,{ERRORCODE:303}),c=null),s(null,c)}},u=c.ads.length;u--;)a=c.ads[u],null!=a.nextWrapperURL&&function(r){var s,o,a;i.length>=10||(a=r.nextWrapperURL,T.call(i,a)>=0)?(t.track(r.errorURLTemplates,{ERRORCODE:302}),c.ads.splice(c.ads.indexOf(r),1),void l()):(0===r.nextWrapperURL.indexOf("//")?(o=location.protocol,r.nextWrapperURL=""+o+r.nextWrapperURL):r.nextWrapperURL.indexOf("://")===-1&&(s=e.slice(0,e.lastIndexOf("/")),r.nextWrapperURL=s+"/"+r.nextWrapperURL),t._parse(r.nextWrapperURL,i,n,function(e,i){var n,s,o,a,u,h,p,d,f,m,v,g,T,y,k,L,R,x;if(s=!1,null!=e)t.track(r.errorURLTemplates,{ERRORCODE:301}),c.ads.splice(c.ads.indexOf(r),1),s=!0;else if(null==i)t.track(r.errorURLTemplates,{ERRORCODE:303}),c.ads.splice(c.ads.indexOf(r),1),s=!0;else for(c.errorURLTemplates=c.errorURLTemplates.concat(i.errorURLTemplates),a=c.ads.indexOf(r),c.ads.splice(a,1),k=i.ads,p=0,d=k.length;p<d;p++){if(u=k[p],u.errorURLTemplates=r.errorURLTemplates.concat(u.errorURLTemplates),u.impressionURLTemplates=r.impressionURLTemplates.concat(u.impressionURLTemplates),null!=r.trackingEvents)for(L=u.creatives,g=0,f=L.length;g<f;g++)if(n=L[g],"linear"===n.type||"nonlinear"===n.type)for(R=Object.keys(r.trackingEvents),T=0,m=R.length;T<m;T++)o=R[T],(h=n.trackingEvents)[o]||(h[o]=[]),n.trackingEvents[o]=n.trackingEvents[o].concat(r.trackingEvents[o]);if(null!=r.videoClickTrackingURLTemplates)for(x=u.creatives,y=0,v=x.length;y<v;y++)n=x[y],"linear"!==n.type&&"nonlinear"!==n.type||(n.videoClickTrackingURLTemplates=n.videoClickTrackingURLTemplates.concat(r.videoClickTrackingURLTemplates));c.ads.splice(a,0,u)}return delete r.nextWrapperURL,l(s)}))}(a);return l()}}(this))},e.childByName=function(e,t){var i,n,r,s;for(s=e.childNodes,n=0,r=s.length;n<r;n++)if(i=s[n],i.nodeName===t)return i},e.childsByName=function(e,t){var i,n,r,s,o;for(n=[],o=e.childNodes,r=0,s=o.length;r<s;r++)i=o[r],i.nodeName===t&&n.push(i);return n},e.parseAdElement=function(e){var t,i,n,r,s;for(r=e.childNodes,i=0,n=r.length;i<n;i++)if(t=r[i],"Wrapper"===(s=t.nodeName)||"InLine"===s){if(t.setAttribute("id",e.getAttribute("id")),"Wrapper"===t.nodeName)return this.parseWrapperElement(t);if("InLine"===t.nodeName)return this.parseInLineElement(t)}},e.parseWrapperElement=function(e){var t,i,n,r,s,o,a;for(t=this.parseInLineElement(e),r=this.childByName(e,"VASTAdTagURI"),null!=r?t.nextWrapperURL=this.parseNodeText(r):null!=(r=this.childByName(e,"VASTAdTagURL"))&&(t.nextWrapperURL=this.parseNodeText(this.childByName(r,"URL"))),a=t.creatives,s=0,o=a.length;s<o;s++)i=a[s],n=null,"linear"!==i.type&&"nonlinear"!==i.type||null!=(n=i)&&(null!=n.trackingEvents&&(t.trackingEvents=n.trackingEvents),null!=n.videoClickTrackingURLTemplates&&(t.videoClickTrackingURLTemplates=n.videoClickTrackingURLTemplates));if(null!=t.nextWrapperURL)return t},e.parseInLineElement=function(e){var t,i,n,r,o,a,l,u,h,c,p,d,f,m,g;for(t=new s,t.id=e.id,f=e.childNodes,l=0,c=f.length;l<c;l++)switch(o=f[l],o.nodeName){case"Error":t.errorURLTemplates.push(this.parseNodeText(o));break;case"Impression":t.impressionURLTemplates.push(this.parseNodeText(o));break;case"Survey":a=new v,a.type=o.getAttribute("type"),a.url=this.parseNodeText(o),t.surveys.push(a);break;case"Creatives":for(m=this.childsByName(o,"Creative"),u=0,p=m.length;u<p;u++)for(n=m[u],!t.creativeId&&n.id&&(t.creativeId=n.id),g=n.childNodes,h=0,d=g.length;h<d;h++)switch(r=g[h],r.nodeName){case"Linear":i=this.parseCreativeLinearElement(r),i&&t.creatives.push(i);break;case"NonLinearAds":i=this.parseNonLinear(r),i&&t.creatives.push(i);break;case"CompanionAds":i=this.parseCompanionAd(r),i&&t.creatives.push(i)}break;case"Extensions":this.parseExtension(t.extensions,this.childsByName(o,"Extension"))}return t},e.parseChildren=function(e,t){var i,n,r,s,o,l;for(o=e.childNodes,l=[],r=0,s=o.length;r<s;r++)i=o[r],"#text"!==i.nodeName?(n=new a(i.nodeName,this.parseNodeText(i)),n.attributes=this.storeNodeAttributes(i),n?(t.children.push(n),null!=i.childNodes?l.push(this.parseChildren(i,n)):l.push(void 0)):l.push(void 0)):l.push(void 0);return l},e.parseExtension=function(e,t){var i,n,r,s,a;for(a=[],r=0,s=t.length;r<s;r++)i=t[r],n=new o,n.attributes=this.storeNodeAttributes(i),this.parseChildren(i,n),a.push(e.push(n));return a},e.storeNodeAttributes=function(e){var t,i,n,r,s;if(i={},e.attributes)for(s=e.attributes,n=0,r=s.length;n<r;n++)t=s[n],i[t.nodeName]=t.nodeValue;return i},e.parseCreativeLinearElement=function(e){var t,i,n,r,s,o,a,l,u,c,d,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_,D,B,I,O,S,M,F;if(n=new h,n.duration=this.parseDuration(this.parseNodeText(this.childByName(e,"Duration"))),n.duration===-1&&"Wrapper"!==e.parentNode.parentNode.parentNode.nodeName)return null;if(m=e.getAttribute("skipoffset"),null==m?n.skipDelay=null:"%"===m.charAt(m.length-1)?(d=parseInt(m,10),n.skipDelay=n.duration*(d/100)):n.skipDelay=this.parseDuration(m),null!=(y=this.childByName(e,"VideoClicks"))){for(n.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(y,"ClickThrough")),B=this.childsByName(y,"ClickTracking"),L=0,w=B.length;L<w;L++)i=B[L],n.videoClickTrackingURLTemplates.push(this.parseNodeText(i));for(I=this.childsByName(y,"CustomClick"),R=0,C=I.length;R<C;R++)r=I[R],n.videoCustomClickURLTemplates.push(this.parseNodeText(r))}for(t=this.childByName(e,"AdParameters"),null!=t&&(n.adParameters=this.parseNodeText(t)),O=this.childsByName(e,"TrackingEvents"),x=0,E=O.length;x<E;x++)for(g=O[x],S=this.childsByName(g,"Tracking"),N=0,U=S.length;N<U;N++)if(v=S[N],s=v.getAttribute("event"),T=this.parseNodeText(v),null!=s&&null!=T){if("progress"===s){if(!(c=v.getAttribute("offset")))continue;s="%"===c.charAt(c.length-1)?"progress-"+c:"progress-"+Math.round(this.parseDuration(c))}null==(k=n.trackingEvents)[s]&&(k[s]=[]),n.trackingEvents[s].push(T)}for(M=this.childsByName(e,"MediaFiles"),_=0,A=M.length;_<A;_++)for(u=M[_],F=this.childsByName(u,"MediaFile"),D=0,b=F.length;D<b;D++)l=F[D],a=new p,a.id=l.getAttribute("id"),a.fileURL=this.parseNodeText(l),a.deliveryType=l.getAttribute("delivery"),a.codec=l.getAttribute("codec"),a.mimeType=l.getAttribute("type"),a.apiFramework=l.getAttribute("apiFramework"),a.bitrate=parseInt(l.getAttribute("bitrate")||0),a.minBitrate=parseInt(l.getAttribute("minBitrate")||0),a.maxBitrate=parseInt(l.getAttribute("maxBitrate")||0),a.width=parseInt(l.getAttribute("width")||0),a.height=parseInt(l.getAttribute("height")||0),f=l.getAttribute("scalable"),f&&"string"==typeof f&&(f=f.toLowerCase(),"true"===f?a.scalable=!0:"false"===f&&(a.scalable=!1)),o=l.getAttribute("maintainAspectRatio"),o&&"string"==typeof o&&(o=o.toLowerCase(),"true"===o?a.maintainAspectRatio=!0:"false"===o&&(a.maintainAspectRatio=!1)),n.mediaFiles.push(a);return n},e.parseNonLinear=function(e){var t,i,n,r,s,o,a,l,u,h,p,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_;for(t=new c,C=this.childsByName(e,"TrackingEvents"),f=0,T=C.length;f<T;f++)for(u=C[f],E=this.childsByName(u,"Tracking"),m=0,y=E.length;m<y;m++)l=E[m],i=l.getAttribute("event"),h=this.parseNodeText(l),null!=i&&null!=h&&(null==(p=t.trackingEvents)[i]&&(p[i]=[]),t.trackingEvents[i].push(h));for(U=this.childsByName(e,"NonLinear"),v=0,k=U.length;v<k;v++){for(o=U[v],s=new d,s.id=o.getAttribute("id")||null,s.width=o.getAttribute("width"),s.height=o.getAttribute("height"),s.minSuggestedDuration=o.getAttribute("minSuggestedDuration"),s.apiFramework=o.getAttribute("apiFramework"),A=this.childsByName(o,"HTMLResource"),g=0,L=A.length;g<L;g++)n=A[g],s.type=n.getAttribute("creativeType")||"text/html",s.htmlResource=this.parseNodeText(n);for(b=this.childsByName(o,"IFrameResource"),N=0,R=b.length;N<R;N++)r=b[N],s.type=r.getAttribute("creativeType")||0,s.iframeResource=this.parseNodeText(r);for(_=this.childsByName(o,"StaticResource"),w=0,x=_.length;w<x;w++)a=_[w],s.type=a.getAttribute("creativeType")||0,s.staticResource=this.parseNodeText(a);s.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(o,"NonLinearClickThrough")),t.variations.push(s)}return t},e.parseCompanionAd=function(e){var t,i,n,r,s,o,a,h,c,p,d,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_;for(n=new u,C=this.childsByName(e,"Companion"),f=0,T=C.length;f<T;f++){for(i=C[f],t=new l,t.id=i.getAttribute("id")||null,t.width=i.getAttribute("width"),t.height=i.getAttribute("height"),E=this.childsByName(i,"HTMLResource"),m=0,y=E.length;m<y;m++)s=E[m],t.type=s.getAttribute("creativeType")||"text/html",t.htmlResource=this.parseNodeText(s);for(U=this.childsByName(i,"IFrameResource"),v=0,k=U.length;v<k;v++)o=U[v],t.type=o.getAttribute("creativeType")||0,t.iframeResource=this.parseNodeText(o);for(A=this.childsByName(i,"StaticResource"),g=0,L=A.length;g<L;g++)a=A[g],t.type=a.getAttribute("creativeType")||0,t.staticResource=this.parseNodeText(a);for(b=this.childsByName(i,"TrackingEvents"),N=0,R=b.length;N<R;N++)for(c=b[N],_=this.childsByName(c,"Tracking"),w=0,x=_.length;w<x;w++)h=_[w],r=h.getAttribute("event"),p=this.parseNodeText(h),null!=r&&null!=p&&(null==(d=t.trackingEvents)[r]&&(d[r]=[]),t.trackingEvents[r].push(p));t.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(i,"CompanionClickThrough")),t.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(i,"CompanionClickTracking")),n.variations.push(t)}return n},e.parseDuration=function(e){var t,i,n,r,s;return null==e?-1:(t=e.split(":"),3!==t.length?-1:(s=t[2].split("."),r=parseInt(s[0]),2===s.length&&(r+=parseFloat("0."+s[1])),n=parseInt(60*t[1]),i=parseInt(60*t[0]*60),isNaN(i||isNaN(n||isNaN(r||n>3600||r>60)))?-1:i+n+r))},e.parseNodeText=function(e){return e&&(e.textContent||e.text||"").trim()},e}(),t.exports=f},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./mediafile":9,"./nonlinear":10,"./response":12,"./survey":13,"./urlhandler":15,"./util":18,events:1}],12:[function(e,t,i){var n;n=function(){function e(){this.ads=[],this.errorURLTemplates=[]}return e}(),t.exports=n},{}],13:[function(e,t,i){var n;n=function(){function e(){this.type=null,this.url=null}return e}(),t.exports=n},{}],14:[function(e,t,i){var n,r,s,o,a,l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=e("./client"),a=e("./util"),s=e("./creative").VASTCreativeLinear,n=e("events").EventEmitter,o=function(e){function t(e,t){var i,n,o;this.ad=e,this.creative=t,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],o=this.creative.trackingEvents;for(i in o)n=o[i],this.trackingEvents[i]=n.slice(0);this.creative instanceof s?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){r.lastSuccessfullAd=+new Date})}return u(t,e),t.prototype.setDuration=function(e){return this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},t.prototype.setProgress=function(e){var t,i,n,r,s,o,a,l,u;if(s=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,s===-1||this.skipable||(s>e?this.emit("skip-countdown",s-e):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(i=[],e>0){i.push("start"),n=Math.round(e/this.assetDuration*100),i.push("progress-"+n+"%"),i.push("progress-"+Math.round(e)),u=this.quartiles;for(r in u)(o=u[r])<=e&&e<=o+1&&i.push(r)}for(a=0,l=i.length;a<l;a++)t=i[a],this.track(t,!0);e<this.progress&&this.track("rewind")}return this.progress=e},t.prototype.setMuted=function(e){return this.muted!==e&&this.track(e?"mute":"unmute"),this.muted=e},t.prototype.setPaused=function(e){return this.paused!==e&&this.track(e?"pause":"resume"),this.paused=e},t.prototype.setFullscreen=function(e){return this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen"),this.fullscreen=e},t.prototype.setSkipDelay=function(e){if("number"==typeof e)return this.skipDelay=e},t.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},t.prototype.errorWithCode=function(e){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:e})},t.prototype.complete=function(){return this.track("complete")},t.prototype.close=function(){return this.track(this.linear?"closeLinear":"close")},t.prototype.stop=function(){},t.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},t.prototype.click=function(){var e,t,i;if((null!=(i=this.clickTrackingURLTemplates)?i.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate)return this.linear&&(t={CONTENTPLAYHEAD:this.progressFormated()}),e=a.resolveURLTemplates([this.clickThroughURLTemplate],t)[0],this.emit("clickthrough",e)},t.prototype.track=function(e,t){var i,n;null==t&&(t=!1),"closeLinear"===e&&null==this.trackingEvents[e]&&null!=this.trackingEvents.close&&(e="close"),n=this.trackingEvents[e],i=this.emitAlwaysEvents.indexOf(e),null!=n?(this.emit(e,""),this.trackURLs(n)):i!==-1&&this.emit(e,""),t===!0&&(delete this.trackingEvents[e],i>-1&&this.emitAlwaysEvents.splice(i,1))},t.prototype.trackURLs=function(e,t){return null==t&&(t={}),this.linear&&(t.CONTENTPLAYHEAD=this.progressFormated()),a.track(e,t)},t.prototype.progressFormated=function(){var e,t,i,n,r;return r=parseInt(this.progress),e=r/3600,e.length<2&&(e="0"+e),t=r/60%60,t.length<2&&(t="0"+t),n=r%60,n.length<2&&(n="0"+t),i=parseInt(100*(this.progress-r)),e+":"+t+":"+n+"."+i},t}(n),t.exports=o},{"./client":3,"./creative":5,"./util":18,events:1}],15:[function(e,t,i){var n,r,s;s=e("./urlhandlers/xmlhttprequest"),r=e("./urlhandlers/flash"),n=function(){function t(){}return t.get=function(t,i,n){var o;return n||("function"==typeof i&&(n=i),i={}),null!=i.response?n(null,i.response):(null!=(o=i.urlhandler)?o.supported():void 0)?i.urlhandler.get(t,i,n):"undefined"==typeof window||null===window?e("./urlhandlers/node").get(t,i,n):s.supported()?s.get(t,i,n):r.supported()?r.get(t,i,n):n()},t}(),t.exports=n},{"./urlhandlers/flash":16,"./urlhandlers/xmlhttprequest":17}],16:[function(e,t,i){var n;n=function(){function e(){}return e.xdr=function(){var e;return window.XDomainRequest&&(e=new XDomainRequest),e},e.supported=function(){return!!this.xdr()},e.get=function(e,t,i){var n,r;return(r="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(r.async=!1,n=this.xdr(),n.open("GET",e),n.timeout=t.timeout||0,n.withCredentials=t.withCredentials||!1,n.send(),n.onprogress=function(){},n.onload=function(){return r.loadXML(n.responseText),i(null,r)}):i()},e}(),t.exports=n},{}],17:[function(e,t,i){var n;n=function(){function e(){}return e.xhr=function(){var e;if("withCredentials"in(e=new window.XMLHttpRequest))return e},e.supported=function(){return!!this.xhr()},e.get=function(e,t,i){var n;if("https:"===window.location.protocol&&0===e.indexOf("http://"))return i(new Error("Cannot go from HTTPS to HTTP."));try{return n=this.xhr(),n.open("GET",e),n.timeout=t.timeout||0,n.withCredentials=t.withCredentials||!1,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.onreadystatechange=function(){if(4===n.readyState)return i(null,n.responseXML)},n.send()}catch(e){return i()}},e}(),t.exports=n},{}],18:[function(e,t,i){var n;n=function(){function e(){}return e.track=function(e,t){var i,n,r,s,o,a;for(n=this.resolveURLTemplates(e,t),a=[],s=0,o=n.length;s<o;s++)i=n[s],"undefined"!=typeof window&&null!==window&&(r=new Image,a.push(r.src=i));return a},e.resolveURLTemplates=function(e,t){var i,n,r,s,o,a,l,u,h;n=[],null==t&&(t={}),"CACHEBUSTING"in t||(t.CACHEBUSTING=Math.round(1e10*Math.random())),t.random=t.CACHEBUSTING;for(u=0,h=e.length;u<h;u++)if(i=e[u],a=i){for(r in t)l=t[r],s="["+r+"]",o="%%"+r+"%%",a=a.replace(s,l),a=a.replace(o,l);n.push(a)}return n},e.storage=function(){var e,t,i;try{i="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){e,i=null}return t=function(e){var t;try{if(t="__VASTUtil__",e.setItem(t,t),e.getItem(t)!==t)return!0}catch(e){return e,!0}return!1},(null==i||t(i))&&(e={},i={length:0,getItem:function(t){return e[t]},setItem:function(t,i){e[t]=i,this.length=Object.keys(e).length},removeItem:function(t){delete e[t],this.length=Object.keys(e).length},clear:function(){e={},this.length=0}}),i}(),e}(),t.exports=n},{}]},{},[8])(8)})}catch(i){try{var e=i.name+" in global t/c: "+i.message+", stack="+i.stack,t="//pixel.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("FREEWHEEL1")+"&ac=1&k="+encodeURIComponent(e)+"&ar="+encodeURIComponent("964d7b8-clean")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=t}catch(e){}}}();
